FROM node:18.6.0

WORKDIR /usr/src/www

# Install packages
COPY package.json yarn.lock ./
RUN yarn install

# Copy files
COPY . .

# Env
# --- Secrets
ARG AWS_REGION
ENV AWS_REGION=$AWS_REGION
ARG AWS_ACCESS_KEY_ID
ENV AWS_ACCESS_KEY_ID=$AWS_ACCESS_KEY_ID
ARG AWS_SECRET_ACCESS_KEY
ENV AWS_SECRET_ACCESS_KEY=$AWS_SECRET_ACCESS_KEY
ARG TARGET_ENV
ENV TARGET_ENV=$TARGET_ENV

# Start
EXPOSE 7000
CMD ["yarn", "preview"]
